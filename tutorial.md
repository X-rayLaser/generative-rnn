# Recurrent neural nets as generative models

In this tutorial, I am going to demonstrate how to use Recurrent 
Neural Nets (RNNs) to generate images with the help of Keras 
framework. Specifically, we are going to treat each image as a 
sequence of pixel intensities. We are going to train RNNs to 
predict the next pixel given all the preceding ones. After the 
training is complete, we will be able to sample newish images 
from this network.

To save computational resources, I will concentrate on using 
MNIST and CIFAR-10 datasets for that purpose. But anyone is 
welcomed to experiment with bigger images. So. Without further 
due, let's begin.

## Prerequisites
First, we need to set up the environment. We create a new folder for
the project, open a terminal and set the current working directory to be
that project's directory
```
cd /path/to/your/project
```

We are going to structure our project in the following way.
```
project\
  generated\
    img1.jpg
    img2.jpg
  trained\
    mnist_models\
      mnist-0.h5
      mnist-1.h5
      mnist-2.h5
      ...
      mnist-9.h5
    cifar_models\
      cifar-0.h5
      cifar-1.h5
      cifar-2.h5
      ...
      cifar-9.h5
  generate.py
  train_mnist.py
  train_cifar.py
  requirements.txt
```
Scripts train_mnist.py and train_cifar will be used to train RNN on 
MNIST and CIFAR-10 datasets respectively. Script "generate.py" will 
generate (hopefully) novel images. "trained" folder will contain all 
trained models, whereas "generated" folder will store all images 
generated by those models. Finally, "requirements.txt" will list 
all Python libraries that we want to install. Let's create all these 
files and folders.
```
mkdir generated
mkdir trained
mkdir trained/mnist_models
mkdir trained/cifar_models
touch generate.py
touch train_mnist.py
touch train_cifar.py
touch requirements.txt
```

Now we create a virtual environment for Python and activate it
```
which python3
/usr/bin/python3
```
```
virtualenv --python='/usr/bin/python3' venv
```

```
. venv/bin/activate
```

Next, in the "requirements.txt", we list the following project 
dependencies
```
numpy
tensorflow<2.0
Keras
Pillow
scikit-image
scikit-learn
```

Finally, we install all the dependencies using the following command
```
pip install -r requirements.txt
```

Fortunately, we do not need to download datasets ourselves. Both 
datasets for our purposes are provided by Keras.


## Building RNN for generating MNIST images

Now we will begin implementing an RNN model.
